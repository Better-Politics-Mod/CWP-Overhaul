#will ultimately be replaced by a_new_constitution
namespace = a_new_constitution

#REGION Legacy of the Resistance
a_new_constitution.101 = {
	type = country_event
	title = a_new_constitution.101.t
	desc = a_new_constitution.101.d
	flavor = a_new_constitution.101.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "floating_billets"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		c:FRA ?= root
		not = {
			has_variable = fra_constitutional_referendum
		}
	}
	option = {
		name = a_new_constitution.101.a
		default_option = yes
		set_variable = fra_constitutional_referendum
		#add_modifier = {
		#	name = legacy_of_the_resistance
		#	years = 20
		#	is_decaying = yes
		#}
		hidden_effect = {
			trigger_event = {
				id = a_new_constitution.102
				days = {
					28
				    30
				}
			}
		}
		ai_chance = {
			base = 100
		}
	}
}

#REGION Drafting a new constitution
a_new_constitution.102 = {
	type = country_event
	title = a_new_constitution.102.t
	desc = a_new_constitution.102.d
	flavor = a_new_constitution.102.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	immediate = {
		if = {
			limit = {
				not = {
					has_variable = drafting_a_new_constitution
				}
			}
			set_variable = drafting_a_new_constitution
		}
		add_journal_entry = { type = fra_a_new_constitution }
	}
	option = {
		name = a_new_constitution.102.a
		default_option = yes
		add_modifier = {
			name = drafting_a_new_constitution
		}
		hidden_effect = {
			trigger_event = {
				id = a_new_constitution.200
			}
		}
		ai_chance = {
			base = 100
		}
	}
}

a_new_constitution.200 = {
    type = country_event
    hidden = yes
    trigger = {}

    immediate = {
        #setup journal entry
        c:FRA = {
            remove_variable = france_constitution_law_events_starter_1_set
            remove_variable = france_constitution_law_events_starter_2_set
            remove_variable = france_constitution_law_events_starter_3_set
            remove_variable = france_constitution_law_events_starter_4_set
            if = {
                limit = {
                    not = {
                        has_variable = drafting_a_new_constitution
                    }
                }
                set_variable = drafting_a_new_constitution
            }
            #idea this value is for the progress bar and goes from 0-100, and is displayed in the journal entry widget
            set_variable = {
                name = fra_constitutional_referendum_success
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_communist_support
                value = 0.5
            }
            set_variable = {
                name = fra_constitutional_referendum_socialist_support
                value = 0.5
            }
            set_variable = {
                name = fra_constitutional_referendum_moralist_support
                value = 0.5
            }
            set_variable = {
                name = fra_constitutional_referendum_gaullist_support
                value = 0.5
            }
            set_variable = {
                name = fra_constitutional_referendum_communist_cumulative_support
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_socialist_cumulative_support
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_moralist_cumulative_support
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_gaullist_cumulative_support
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_communist_cumulative_support_weighted
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_socialist_cumulative_support_weighted
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_moralist_cumulative_support_weighted
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_gaullist_cumulative_support_weighted
                value = 0
            }
            set_variable = {
                name = fra_constitutional_referendum_net_change_weighted
                value = 0
            }
        }
        trigger_event = { id = a_new_constitution.201 }
    }
}

a_new_constitution.201 = {
    type = country_event
    hidden = yes
    trigger = {}

    immediate = {
        france_constitution_law_events_launcher = yes
    }
}

# Head of state event
a_new_constitution.210 = {
	type = country_event
	title = a_new_constitution.210.t
	desc = a_new_constitution.210.d
	flavor = a_new_constitution.210.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	immediate = {
        hidden_effect = {
            set_variable = fra_constitutional_referendum_on_pause
        }
	}

    # sum communist = -10 + 00 + 20 = +05
    # sum socialist =  00 + 10 - 10 = +00
    # sum moralist  =  10 + 05 - 20 = +05
    # sum gaullist  =  10 + 00 - 20 = -05
    #                   =    =    =    =
    # total sum     =  05   15  -30  = 05

	#OPT Executive
	#Net change = 10
	option = {
		name = a_new_constitution.210.a
		activate_law = law_type:law_executive

		change_variable = {
			name = fra_constitutional_referendum_communist_support
			subtract = 4
		}
		change_variable = {
			name = fra_constitutional_referendum_socialist_support
			subtract = 00
		}
		change_variable = {
			name = fra_constitutional_referendum_moralist_support
			add = 3
		}
		change_variable = {
			name = fra_constitutional_referendum_gaullist_support
			add = 4
		}

		hidden_effect = {
			trigger_event = {
				id = a_new_constitution.201
			}
			remove_variable = fra_constitutional_referendum_on_pause
		}
		ai_chance = {
			base = 60
		}
	}

	#OPT Parliamentary
	#Net change = 20
    option = {
        name = a_new_constitution.210.b
        activate_law = law_type:law_parliamentary

        change_variable = {
            name = fra_constitutional_referendum_communist_support
            add = 2
        }
        change_variable = {
            name = fra_constitutional_referendum_socialist_support
            add = 3
        }
        change_variable = {
            name = fra_constitutional_referendum_moralist_support
            add = 1
        }
        change_variable = {
            name = fra_constitutional_referendum_gaullist_support
            subtract = 2
        }

        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.201
            }
            remove_variable = fra_constitutional_referendum_on_pause
        }
        ai_chance = {
            base = 60
        }
    }

    #OPT Council Elective
	#Net change = -10
    option = {
        name = a_new_constitution.210.c
        activate_law = law_type:law_council_elective

        change_variable = {
            name = fra_constitutional_referendum_communist_support
            add = 8
        }
        change_variable = {
            name = fra_constitutional_referendum_socialist_support
            subtract = 4
        }
        change_variable = {
            name = fra_constitutional_referendum_moralist_support
            subtract = 8
        }
        change_variable = {
            name = fra_constitutional_referendum_gaullist_support
            subtract = 8
        }

        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.201
            }
            remove_variable = fra_constitutional_referendum_on_pause
        }
        ai_chance = {
            base = 60
        }
    }
}


# Distribution of power event
a_new_constitution.211 = {
	type = country_event
	title = a_new_constitution.211.t
	desc = a_new_constitution.211.d
	flavor = a_new_constitution.211.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	immediate = {
        hidden_effect = {
            set_variable = fra_constitutional_referendum_on_pause
        }
	}

    # sum communist = -10 + 05 + 10 = +05
    # sum socialist = -05 + 10 + 00 = +05
    # sum moralist  =  05 + 05 - 10 = +00
    # sum gaullist  =  10 + 00 - 10 = -05
    #                   =    =    =    =
    # total sum     =  05   15  -15 = +05

	#OPT representative democracy
	#Net change = 20
	option = {
		name = a_new_constitution.211.a
		activate_law = law_type:law_representative_democracy

		change_variable = {
			name = fra_constitutional_referendum_communist_support
			subtract = 2
		}
		change_variable = {
			name = fra_constitutional_referendum_socialist_support
			subtract = 1
		}
		change_variable = {
			name = fra_constitutional_referendum_moralist_support
			add = 2
		}
		change_variable = {
			name = fra_constitutional_referendum_gaullist_support
			add = 3
		}

		hidden_effect = {
			trigger_event = {
				id = a_new_constitution.201
			}
			remove_variable = fra_constitutional_referendum_on_pause
		}
		ai_chance = {
			base = 60
		}
	}

	#OPT Consensus democracy
	#Net change = 20
    option = {
        name = a_new_constitution.211.b
        activate_law = law_type:law_consensus_democracy

        change_variable = {
            name = fra_constitutional_referendum_communist_support
            add = 1
        }
        change_variable = {
            name = fra_constitutional_referendum_socialist_support
            add = 2
        }
        change_variable = {
            name = fra_constitutional_referendum_moralist_support
            add = 1
        }
        change_variable = {
            name = fra_constitutional_referendum_gaullist_support
            subtract = 0
        }

        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.201
            }
            remove_variable = fra_constitutional_referendum_on_pause
        }
        ai_chance = {
            base = 60
        }
    }

    #OPT Direct Democracy
	#Net change = -10
    option = {
        name = a_new_constitution.211.c
        activate_law = law_type:law_direct_democracy

        change_variable = {
            name = fra_constitutional_referendum_communist_support
            add = 4
        }
        change_variable = {
            name = fra_constitutional_referendum_socialist_support
            subtract = 0
        }
        change_variable = {
            name = fra_constitutional_referendum_moralist_support
            subtract = 3
        }
        change_variable = {
            name = fra_constitutional_referendum_gaullist_support
            subtract = 3
        }

        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.201
            }
            remove_variable = fra_constitutional_referendum_on_pause
        }
        ai_chance = {
            base = 60
        }
    }
}

# Centralisation
a_new_constitution.212 = {
	type = country_event
	title = a_new_constitution.212.t
	desc = a_new_constitution.212.d
	flavor = a_new_constitution.212.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	immediate = {
        hidden_effect = {
            set_variable = fra_constitutional_referendum_on_pause
        }
	}

    # sum communist =  10 - 05 - 10 = -05
    # sum socialist =  05 + 00 - 05 = +00
    # sum moralist  = -10 + 05 + 15 = +05
    # sum gaullist  =  10 + 05 - 10 = +05
    #                   =    =    =    =
    # total sum     =  15   05  -15  = +05

	#OPT unitary
	#Net change = 20
	option = {
		name = a_new_constitution.212.a
		activate_law = law_type:law_unitary

		change_variable = {
			name = fra_constitutional_referendum_communist_support
			add = 3
		}
		change_variable = {
			name = fra_constitutional_referendum_socialist_support
			add = 1
		}
		change_variable = {
			name = fra_constitutional_referendum_moralist_support
			subtract = 3
		}
		change_variable = {
			name = fra_constitutional_referendum_gaullist_support
			add = 3
		}

		hidden_effect = {
			trigger_event = {
				id = a_new_constitution.201
			}
			remove_variable = fra_constitutional_referendum_on_pause
		}
		ai_chance = {
			base = 60
		}
	}

	#OPT devolved
	#Net change = 0
    option = {
        name = a_new_constitution.212.b
        activate_law = law_type:law_devolved

        change_variable = {
            name = fra_constitutional_referendum_communist_support
            add = 1
        }
        change_variable = {
            name = fra_constitutional_referendum_socialist_support
            add = 1
        }
        change_variable = {
            name = fra_constitutional_referendum_moralist_support
            add = 3
        }
        change_variable = {
            name = fra_constitutional_referendum_gaullist_support
            subtract = 1
        }

        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.201
            }
            remove_variable = fra_constitutional_referendum_on_pause
        }
        ai_chance = {
            base = 60
        }
    }

    #OPT federal
	#Net change = -10
    option = {
        name = a_new_constitution.212.c
        activate_law = law_type:law_federalized

        change_variable = {
            name = fra_constitutional_referendum_communist_support
            subtract = 4
        }
        change_variable = {
            name = fra_constitutional_referendum_socialist_support
            subtract = 2
        }
        change_variable = {
            name = fra_constitutional_referendum_moralist_support
            add = 6
        }
        change_variable = {
            name = fra_constitutional_referendum_gaullist_support
            subtract = 2
        }

        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.201
            }
            remove_variable = fra_constitutional_referendum_on_pause
        }
        ai_chance = {
            base = 60
        }
    }
}

# Economic system event
a_new_constitution.213 = {
	type = country_event
	title = a_new_constitution.213.t
	desc = a_new_constitution.213.d
	flavor = a_new_constitution.213.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	immediate = {
        hidden_effect = {
            set_variable = fra_constitutional_referendum_on_pause
        }
	}


    # sum communist = -10 + 00 + 20 = +00
    # sum socialist =  05 + 10 - 10 = +05
    # sum moralist  =  10 + 05 - 20 = -05
    # sum gaullist  =  10 + 05 - 20 = +05
    #                   =    =    =    =
    # total sum     =  15   20  -30  = +05

	#OPT Free market
	#Net change = 0
	option = {
		name = a_new_constitution.213.a
		activate_law = law_type:law_free_market

		change_variable = {
			name = fra_constitutional_referendum_communist_support
			subtract = 8
		}
		change_variable = {
			name = fra_constitutional_referendum_socialist_support
			subtract = 6
		}
		change_variable = {
			name = fra_constitutional_referendum_moralist_support
			subtract = 4
		}
		change_variable = {
			name = fra_constitutional_referendum_gaullist_support
			subtract = 2
		}

		hidden_effect = {
			trigger_event = {
				id = a_new_constitution.201
			}
			remove_variable = fra_constitutional_referendum_on_pause
		}
		ai_chance = {
			base = 60
		}
	}

	#OPT interventionism
	#Net change = 30
    option = {
        name = a_new_constitution.213.b
        activate_law = law_type:law_interventionism

        change_variable = {
            name = fra_constitutional_referendum_communist_support
            add = 1
        }
        change_variable = {
            name = fra_constitutional_referendum_socialist_support
            add = 3
        }
        change_variable = {
            name = fra_constitutional_referendum_moralist_support
            add = 2
        }
        change_variable = {
            name = fra_constitutional_referendum_gaullist_support
            add = 2
        }

        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.201
            }
            remove_variable = fra_constitutional_referendum_on_pause
        }
        ai_chance = {
            base = 60
        }
    }

    #OPT socialization
	#Net change = -20
    option = {
        name = a_new_constitution.213.c
        activate_law = law_type:law_socialization

        change_variable = {
            name = fra_constitutional_referendum_communist_support
            add = 8
        }
        change_variable = {
            name = fra_constitutional_referendum_socialist_support
            subtract = 4
        }
        change_variable = {
            name = fra_constitutional_referendum_moralist_support
            subtract = 8
        }
        change_variable = {
            name = fra_constitutional_referendum_gaullist_support
            subtract = 8
        }

        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.201
            }
            remove_variable = fra_constitutional_referendum_on_pause
        }
        ai_chance = {
            base = 60
        }
    }
}

#REGION: Referendum on the New Constitution
a_new_constitution.601 = {
	type = country_event
	title = a_new_constitution.601.t
	desc = a_new_constitution.601.d
	flavor = a_new_constitution.601.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	immediate = {
        hidden_effect = {
            set_variable = fra_constitutional_referendum_on_pause
        }
    }
	#OPT: VOTING!
	option = {
		name = a_new_constitution.601.a
		default_option = yes
		if = {
			limit = {
				root.var:fra_constitutional_referendum_success >= 80
			}
			#opt: trigger landslide approval event
			hidden_effect = {
				trigger_event = {
					id = a_new_constitution.701
					days = {
						30
						60
					}
				}
			}
		}
		else_if = {
			limit = {
				root.var:fra_constitutional_referendum_success >= 60
			}
			#opt: trigger approve event
			hidden_effect = {
				trigger_event = {
					id = a_new_constitution.705
					days = {
						1
						8
					}
				}
			}
		}
		else_if = {
			limit = {
				root.var:fra_constitutional_referendum_success >= 50
			}
			#opt: trigger approve narrow margin event
			hidden_effect = {
				trigger_event = {
					id = a_new_constitution.702
					days = {
						1
						8
					}
				}
			}
		}
		else_if = {
			limit = {
				root.var:fra_constitutional_referendum_success >= 40
			}
			#opt: trigger reject narrow margin event
			hidden_effect = {
				trigger_event = {
					id = a_new_constitution.703
					days = {
						1
						8
					}
				}
			}
		}
		else = {
			#opt: trigger reject event
			hidden_effect = {
				trigger_event = {
					id = a_new_constitution.704
					days = {
						1
						8
					}
				}
			}
		}
		hidden_effect = {
		    remove_variable = fra_constitutional_referendum_on_pause
		}
		ai_chance = {
			base = 100
		}
	}
}

#REGION: Constitution Approved by a Landslide
a_new_constitution.701 = {
	type = country_event
	title = a_new_constitution.701.t
	desc = a_new_constitution.701.d
	flavor = a_new_constitution.701.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	#OPT: Landslide approval!
	option = {
		name = a_new_constitution.701.a
		default_option = yes
		add_modifier = {
			name = legitimate_constitution
			years = 20
			is_decaying = yes
		}
		call_election = {
            months = 1
        }
		remove_modifier = drafting_a_new_constitution
		remove_variable = drafting_a_new_constitution
		hidden_effect = {
			set_variable = IVth_Republic
		}
		ai_chance = {
			base = 100
		}
	}
}

#REGION: Constitution Approved by a Narrow Margin
a_new_constitution.702 = {
	type = country_event
	title = a_new_constitution.702.t
	desc = a_new_constitution.702.d
	flavor = a_new_constitution.702.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	#OPT: Narrow Margin Approval!
	option = {
		name = a_new_constitution.702.a
		default_option = yes

		add_modifier = {
			name = weak_constitution
			years = 20
			is_decaying = yes
		}
		remove_modifier = drafting_a_new_constitution
		remove_variable = drafting_a_new_constitution

		call_election = {
        	months = 1
        }
		hidden_effect = {
			set_variable = IVth_Republic
		}
		ai_chance = {
			base = 100
		}
	}
}

#REGION: Constitution Rejected by a Narrow Margin
a_new_constitution.703 = {
	type = country_event
	title = a_new_constitution.703.t
	desc = a_new_constitution.703.d
	flavor = a_new_constitution.703.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	#OPT: Narrow Margin Rejection!
	option = {
		name = a_new_constitution.703.a
		default_option = yes
		#add_modifier = {
		#	name = failed_constitutional_project
		#	months = 12
		#	is_decaying = yes
		#}
        hidden_effect = {
            trigger_event = {
                id = a_new_constitution.200
            }
        }
		ai_chance = {
			base = 100
		}
	}
}

#REGION: Constitution Rejected by a Landslide
a_new_constitution.704 = {
	type = country_event
	title = a_new_constitution.704.t
	desc = a_new_constitution.704.d
	flavor = a_new_constitution.704.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	#OPT: Landslide Rejection!
	option = {
		name = a_new_constitution.704.a
		default_option = yes
		add_modifier = {
			name = failed_constitutional_project
			months = 12
			multiplier = 2
			is_decaying = yes
		}
		hidden_effect = {
            trigger_event = {
                id = a_new_constitution.200
            }
        }
		ai_chance = {
			base = 100
		}
	}
}

#REGION: Constitution Approved
a_new_constitution.705 = {
	type = country_event
	title = a_new_constitution.705.t
	desc = a_new_constitution.705.d
	flavor = a_new_constitution.705.f
	icon = "gfx/interface/icons/event_icons/event_default.dds"
	event_image = {
		video = "gfx/event_pictures/middleeast_courtroom_upheaval.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/middleeast/courtroom_upheaval"
	duration = 1
	trigger = {
		#triggered from previous event
		always = yes
	}
	#OPT: Narrow Margin Approval!
	option = {
		name = a_new_constitution.702.a
		default_option = yes

		remove_modifier = drafting_a_new_constitution
		remove_variable = drafting_a_new_constitution

		call_election = {
        	months = 1
        }
		hidden_effect = {
			set_variable = IVth_Republic
		}
		ai_chance = {
			base = 100
		}
	}
}
