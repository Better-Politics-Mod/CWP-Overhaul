namespace = wmd_attack_events

wmd_attack_events.1 = { # Confirmation Dialogue for ending the world
	type = country_event
	placement = ROOT
	title = wmd_attack_events.1.t
	desc = wmd_attack_events.1.d
	flavor = wmd_attack_events.1.f

	duration = 3
	icon = "gfx/interface/icons/lens_toolbar_icons/nuclear_weapons.dds"

	event_image = {
		video = "gfx/event_pictures/europenorthamerica_springtime_of_nations.bk2"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

	immediate = {
		ROOT = {
			save_scope_as = initiator
		}
		every_in_list = {
			variable = wmd_target_list
			save_scope_as = target
		}
	}
	# TODO - AI SCRIPTING
	option = {
		name = wmd_attack_events.1.a
		highlighted_option = yes
		every_in_list = {
			variable = wmd_target_list
			random_list = {
				1 = {
					modifier = {
						add = nuclear_strike_delivery_effectiveness
					}
					this = {
						save_scope_as = target
					}
					trigger_event = {
						id = wmd_attack_events.2
					}
				}
				1 = {
					modifier = {
						add = nuclear_strike_delivery_effectiveness_negate
					}
					this = {
						save_scope_as = target
					}
					trigger_event = {
						id = wmd_attack_events.3
					}
				}
			}
		}
		change_variable = {
			name = nuclear_stockpile
			subtract = {
				value = nuclear_stockpile_sv
				multiply = nuclear_deployment_percentage_sv
			}
		}
		clear_variable_list = wmd_target_list
		clear_variable_list = wmd_target_list_c
	}
	option = {
		name = wmd_attack_events.1.b
	}

}

wmd_attack_events.2 = { # Successful Nuclear Strike
	type = state_event
	placement = ROOT
	title = wmd_attack_events.2.t
	desc = wmd_attack_events.2.d
	flavor = wmd_attack_events.2.f

	duration = 3
	icon = "gfx/interface/icons/lens_toolbar_icons/nuclear_weapons.dds"

	event_image = {
		video = "atomic_bomb"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/europenorthamerica/springtime_of_nation"

	immediate = {
		kill_population_percent_in_state = {
			percent = scope:target.nuclear_strike_population_kill
		}
		THIS.state_region = {
			add_devastation = scope:target.nuclear_strike_devastation
		}
		set_variable = {
			name = nuclear_strike_entity
			days = 14
		}
		add_modifier = {
			name = nuclear_strike
			multiplier = scope:target.nuclear_strike_radiation
			is_decaying = yes
			years = 20
		}
		if = {
			limit = {
				scope:target.owner = {
					not = {
						has_war_with = scope:initiator
					}
				}
				not = {
					scope:target.owner = scope:initiator
				}
			}
			scope:initiator = {
				change_infamy = scope:target.nuclear_strike_effectiveness_state
				create_diplomatic_play = {
					escalation = 100
					war = yes
					initiator = scope:initiator
					target_country = scope:target.owner
					type = dp_humiliation

					add_war_goal = {
						holder = scope:target.owner
						type = contain_threat
						target_country = scope:initiator
					}
				}
			}
		}
	}
	# TODO - AI SCRIPTING
	option = {
		name = wmd_attack_events.2.a
		highlighted_option = yes

	}
}

wmd_attack_events.3 = { # Failed Nuclear Strike
	type = state_event
	placement = ROOT
	title = wmd_attack_events.3.t
	desc = wmd_attack_events.3.d
	flavor = wmd_attack_events.3.f

	duration = 3
	icon = "gfx/interface/icons/lens_toolbar_icons/nuclear_weapons.dds"

	event_image = {
		video = "atomic_bomb"
	}
	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/europenorthamerica/springtime_of_nation"

	immediate = {
		scope:initiator = {
			create_incident = {
				country = scope:target.owner
				value = scope:target.nuclear_strike_effectiveness_state
			}
		}
	}
	# TODO - AI SCRIPTING
	option = {
		name = wmd_attack_events.3.a
		highlighted_option = yes

	}
}
