je_gaddafi_unification_target = {
	icon = "gfx/interface/icons/lens_toolbar_icons/unused/diplomatic_actions.dds"
	should_be_pinned_by_default = yes

	is_shown_when_inactive = {
		c:LBY = {
			any_scope_character = {
				is_ruler = yes
				has_ideology = ideology:ideology_third_international_theory
			}
		}
	}

	possible = {
		has_variable = gaddafi_unification_target
	}

	immediate = {
	}

	on_weekly_pulse = {
		effect = {

			#Requires >10 per week to be successful
			#Requires >7 per week to reach >75

			if = { #Libya has a higher rank
				limit = {
					global_country_ranking > c:LBY.global_country_ranking
				}
				c:LBY = {
					change_variable = {
						name = gaddafi_unification_points
						add = 4
					}
				}
			}
			if = { #Libya has a stronger millitary
				limit = {
					army_reserves < c:LBY.army_reserves
				}
				c:LBY = {
					change_variable = {
						name = gaddafi_unification_points
						add = 4
					}
				}
			}
			if = { #Libya is a major power
				limit = {
					c:LBY.country_rank >= rank_value:major_power
				}
				c:LBY = {
					change_variable = {
						name = gaddafi_unification_points
						add = 3
					}
				}
			}
			if = { #We are neighbors; This apparently includes (some) oversea routes? It triggers for Morocco, but not Mauritania
				limit = {
					OR = {
						is_adjacent = c:LBY
						c:LBY = {
							any_subject_or_below = { 
								is_adjacent = ROOT
								count >= 1
							}
						}
					}
				}
				c:LBY = {
					change_variable = {
						name = gaddafi_unification_points
						add = 2
					}
				}
			}
			if = { #We like Libya
				limit = {
					c:LBY = {
						THIS.relations:root >= relations_threshold:friendly
					}
				}
				c:LBY = {
					change_variable = {
						name = gaddafi_unification_points
						add = 2
					}
				}
			}
			c:LBY = {
				change_variable = {
					name = gaddafi_unification_points
					add = 1
				}
			}
		}
	}

	is_progressing = {
	}
	progressbar = yes

	current_value = {
		value = c:LBY.var:gaddafi_unification_points
	}

	goal_add_value = {
		add = 100
	}

	timeout = 80

	on_timeout = {
		if = {
			limit = {
				c:LBY.var:gaddafi_unification_points >= 75
			}
			save_scope_as = libya_coup_target
			c:LBY = { trigger_event = libya.8 }
		}
		else = { c:LBY = { trigger_event = libya.7 } }
		remove_global_variable = gaddafi_unification_ongoing
		c:LBY = {
			set_variable = {
				name = gaddafi_unification_points
				value = 0
			}
		}
	}

	complete = {
		c:LBY.var:gaddafi_unification_points >= 100
	}

	on_complete = {
		c:LBY = {
			create_diplomatic_pact = {
				country = PREV
				type = jamahiriya
			}
			trigger_event = libya.6
		}
		remove_global_variable = gaddafi_unification_ongoing
		c:LBY = {
			set_variable = {
				name = gaddafi_unification_points
				value = 0
			}
		}
	}

	fail = {
		NOT = { c:LBY = { has_journal_entry = je_gaddafi_unification } }
	}

	on_fail = {
		remove_global_variable = gaddafi_unification_ongoing
		c:LBY = {
			set_variable = {
				name = gaddafi_unification_points
				value = 0
			}
		}
	}

	weight = 100
}