onaction_imf_calculation = {
    if = {
        limit = {
            is_target_in_global_variable_list = {
                name = imf_members
                target = this
            }
        }
        onaction_imf_contribution_calculation = yes
        onaction_imf_debt_interest_growth = yes
        onaction_debt_payment_calculation = yes
        order_imf_gdp_list = yes
        order_imf_contributors_list = yes
        order_imf_debtor_list = yes
    }
}

onaction_imf_contribution_calculation = {
    if = {
        limit = {
            imf_contribution_percent_value > 0.1
        }
        remove_modifier = imf_contribution
        add_modifier = {
            name = imf_contribution
            multiplier = imf_contribution_money
        }
        change_variable = {
            name = imf_contribution
            add = imf_contribution_money_to_usd
        }
        change_global_variable = {
            name = imf_reserves
            add = imf_contribution_money_to_usd
        }
    }
    if = {
        limit = {
            imf_contribution_percent_value <= 0
        }
        remove_modifier = imf_contribution
    }

}

onaction_imf_debt_interest_growth = {
    if = {
        limit = {
            var:imf_debt >= 1
        }
        change_variable = {
            name = imf_debt
            add = imf_debt_interest_growth
        }
    }
}

onaction_debt_payment_calculation = {
    remove_modifier = imf_debt_payment
    if = {
        limit = {
            imf_debt_monthly_payment_percentage >= 1
            var:imf_debt >= 1
        }
        add_modifier = {
            name = imf_debt_payment
            multiplier = imf_debt_monthly_payment_value_domestic
        }
        change_variable = {
            name = imf_debt
            subtract = imf_debt_monthly_payment_value
        }
    }
    if = {
        limit = {
            var:imf_debt < 0
        }
        set_variable = {
            name = imf_debt
            value = 0
        }
    }
    remove_modifier = imf_credit_returns
    add_modifier = {
        name = imf_credit_returns
        multiplier = imf_credit_returns_mult
    }
}

order_imf_gdp_list = {
	clear_global_variable_list = imf_gdp_sorted
	ordered_in_global_list = {
		variable = imf_members
		order_by = gdp
		max = 1000
		check_range_bounds = no
		THIS = {
			add_to_global_variable_list = {
				name = imf_gdp_sorted
				target = prev
			}
		}
	}
}

order_imf_contributors_list = {
	clear_global_variable_list = imf_contributors_sorted
	ordered_in_global_list = {
		variable = imf_members
		order_by = imf_contribution_share
		max = 1000
		check_range_bounds = no
		THIS = {
			add_to_global_variable_list = {
				name = imf_contributors_sorted
				target = prev
			}
		}
	}
}

order_imf_debtor_list = {
	clear_global_variable_list = imf_debtor_sorted
	ordered_in_global_list = {
		variable = imf_members
		order_by = imf_debt_value
		max = 1000
		check_range_bounds = no
		THIS = {
			add_to_global_variable_list = {
				name = imf_debtor_sorted
				target = prev
			}
		}
	}
}